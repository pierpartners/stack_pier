<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>n8n Dependency Visualizer</title>
    <!-- External Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <!-- Custom Styles -->
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <!-- Dashboard Sidebar -->
        <div class="sidebar">
            <h1>n8n Dependencies</h1>

            <!-- Loader / Connection Panels -->
            <div id="connectionPanel">
                <div id="dataFreshness"
                    style="display:none; background: #161b22; border: 1px solid #30363d; padding: 10px; border-radius: 6px; margin-bottom: 12px;">
                    <div style="font-size: 11px; color: #8b949e; margin-bottom: 8px;">
                        Ãšltima atualizaÃ§Ã£o: <strong id="lastUpdateDate" style="color: #e6edf3;">Buscando...</strong>
                    </div>
                    <button id="refreshDataBtn" onclick="triggerGitHubAction()" class="secondary"
                        style="font-size: 11px; padding: 4px 8px; width: fit-content;">ðŸ”„ Atualizar Dados</button>
                </div>

                <div id="autoLoadStatus" style="display:none; color: #8b949e; font-size: 13px; margin-bottom: 12px;">
                </div>

            </div>

            <!-- Global Stats -->
            <div class="stats">
                <div class="stat-box">
                    <div class="stat-value" id="workflowCount">0</div>
                    <div class="stat-label">Fluxos</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="sourceCount">0</div>
                    <div class="stat-label">Fontes</div>
                </div>
            </div>

            <!-- Search Filter -->
            <input type="text" id="searchInput" placeholder="ðŸ” Buscar fluxo, ferramenta ou tabela...">

            <!-- Tool Filtering List (Generated by JS) -->
            <h2>Filtrar por Fonte</h2>
            <div id="toolsList"></div>

            <!-- Dependency Impact Analysis -->
            <div id="impactPanel" class="impact-panel" style="display: none;">
                <div class="impact-title">Impacto da DependÃªncia</div>
                <div id="impactText">Os seguintes fluxos dependem desta fonte:</div>
                <ul class="impact-list" id="impactList"></ul>
            </div>
        </div>

        <!-- Main Visualizer Area -->
        <div class="main-content">
            <div class="controls">
                <!-- Group Legend & Toggles -->
                <div class="legend" id="legend"></div>

                <div class="export-btn">
                    <button class="secondary" onclick="resetZoom()">ðŸ”„ Reset Zoom</button>
                    <button class="secondary" onclick="exportMarkdown()">ðŸ“„ Exportar RelatÃ³rio</button>
                </div>
            </div>
            <!-- SVG Graph Rendered Here -->
            <div class="graph-container" id="graph"></div>
        </div>
    </div>

    <!-- Application Core Logic -->
    <script src="app.js"></script>
</body>

</html>